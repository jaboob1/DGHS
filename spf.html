<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>حاسبة معاش التقاعد - صندوق الحماية الاجتماعية (عُمان)</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f7f9fc;margin:0;padding:20px;direction:rtl}
    .container{max-width:800px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
    h1{margin:0 0 10px;font-size:20px}
    label{display:block;margin-top:12px;font-weight:bold}
    input,select{width:100%;padding:8px;margin-top:4px;border:1px solid #ccc;border-radius:6px}
    .btn{margin-top:16px;background:#0b72d9;color:#fff;border:none;padding:10px 15px;border-radius:6px;cursor:pointer}
    .result{margin-top:20px;padding:12px;background:#eef6ff;border-radius:6px}
    .highlight{font-weight:bold;font-size:18px;color:#064e3b}
  </style>
</head>
<body>
  <div class="container">
    <h1>حاسبة مبسطة لمعاش التقاعد</h1>
    <p>النظام يحسب على أساس 2% × سنوات الخدمة × الراتب (مع إعادة تقييم الأجور بنسبة نمو 3% للخدمة اللاحقة).</p>

    <label>سنوات الخدمة السابقة</label>
    <input id="years_prev" type="number" value="13">

    <label>سنوات الخدمة اللاحقة</label>
    <input id="years_after" type="number" value="15">

    <label>الراتب الحالي (ريال عماني)</label>
    <input id="salary_now" type="number" value="890">

    <button class="btn" onclick="calc()">احسب المعاش</button>

    <div id="result" class="result" style="display:none">
      <p><strong>المعاش التقاعدي المقدر:</strong> <span id="finalAmount" class="highlight"></span> ر.ع</p>
      <p id="detail_prev"></p>
      <p id="detail_after"></p>
      <p id="detail_avg"></p>
    </div>
  </div>

<script>
function calc(){
  const yearsPrev = parseFloat(document.getElementById('years_prev').value)||0;
  const yearsAfter = parseFloat(document.getElementById('years_after').value)||0;
  const salaryNow = parseFloat(document.getElementById('salary_now').value)||0;

  const growth = 0.03; // نسبة النمو 3%

  // الراتب عند التقاعد بعد كل الخدمة (نهاية الفترة اللاحقة)
  const salaryAtRetire = salaryNow * Math.pow(1+growth, yearsAfter);

  // متوسط القيمة المستقبلية للأجور للخدمة اللاحقة:
  // = salaryNow * (( (1+g)^yearsAfter - 1) / (yearsAfter * g))
  const avgFuture = salaryNow * ( (Math.pow(1+growth, yearsAfter) - 1) / (yearsAfter * growth) ) * (1+growth);

  // مكوّن الخدمة السابقة (باستخدام الراتب عند التقاعد)
  const prevPart = 0.02 * yearsPrev * salaryAtRetire;

  // مكوّن الخدمة اللاحقة (باستخدام المتوسط المحسوب)
  const afterPart = 0.02 * yearsAfter * avgFuture;

  const total = prevPart + afterPart;

  document.getElementById('result').style.display='block';
  document.getElementById('finalAmount').textContent = total.toFixed(2);

  document.getElementById('detail_prev').textContent =
    `الخدمة السابقة: 2% × ${yearsPrev} × ${salaryAtRetire.toFixed(2)} = ${prevPart.toFixed(2)} ر.ع`;

  document.getElementById('detail_after').textContent =
    `الخدمة اللاحقة: 2% × ${yearsAfter} × متوسط الأجور المستقبلية (${avgFuture.toFixed(2)}) = ${afterPart.toFixed(2)} ر.ع`;

  document.getElementById('detail_avg').textContent =
    `متوسط القيمة المستقبلية للأجور محسوب تلقائيًا بنسبة نمو 3% = ${avgFuture.toFixed(2)} ر.ع`;
}
</script>
</body>
</html>